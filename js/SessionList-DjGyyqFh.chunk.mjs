import{t as a}from"./NcLoadingIcon-CUmxDbg7.chunk.mjs";import{s as o,c as u,d as l,b as c}from"./NcNoteCard-ChweF_5Q-B2F_fEiN.chunk.mjs";import{n as i}from"./_plugin-vue2_normalizer-XSZyZ-Zg.chunk.mjs";import{N as p,k as m,l as d,n as g}from"./EditorOutline-De8KinFC.chunk.mjs";import{C as h,a as f}from"./Editor-C1UZLgwb.chunk.mjs";import{_ as v}from"./index-CCUE3e_p.chunk.mjs";import"./emoji-picker-DwlFXcXb.chunk.mjs";import"./vue.runtime.esm-THy86O83.chunk.mjs";import"./index-CBjMXwUt.chunk.mjs";import"./NcCheckboxRadioSwitch-ip_mRd2T-C-ygdYOv.chunk.mjs";import"./MediaHandler.provider-BkVIW0cW.chunk.mjs";import"./index-B8nYQ_zQ.chunk.mjs";import"./logger-C5ZHccIX.chunk.mjs";import"./index-BfIpqxnF.chunk.mjs";import"./dav-CQDyL7M_-BFSVhQlx.chunk.mjs";import"./MenuBar-BJGqFlM7.chunk.mjs";const N={name:"AccountMultipleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var b=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon account-multiple-outline-icon",attrs:{"aria-hidden":t.title?null:"true","aria-label":t.title,role:"img"},on:{click:function(s){return t.$emit("click",s)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M13.07 10.41A5 5 0 0 0 13.07 4.59A3.39 3.39 0 0 1 15 4A3.5 3.5 0 0 1 15 11A3.39 3.39 0 0 1 13.07 10.41M5.5 7.5A3.5 3.5 0 1 1 9 11A3.5 3.5 0 0 1 5.5 7.5M7.5 7.5A1.5 1.5 0 1 0 9 6A1.5 1.5 0 0 0 7.5 7.5M16 17V19H2V17S2 13 9 13 16 17 16 17M14 17C13.86 16.22 12.67 15 9 15S4.07 16.31 4 17M15.95 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},y=[],_=i(N,b,y,!1,null,null);const C=_.exports,x={name:"AvatarWrapper",components:{NcAvatar:p},props:{session:{type:Object,required:!0},size:{type:Number,default:()=>32}},computed:{sessionAvatarStyle(){return{...this.sessionBackgroundStyle,"border-color":this.session.color,"border-width":"2px","border-style":"solid","--size":this.size+"px","--font-size":this.size/2+"px"}},sessionBackgroundStyle(){return{"background-color":this.session.userId?this.session.color+" !important":"#b9b9b9"}},guestInitial(){return this.session.guestName===""?"?":this.session.guestName.slice(0,1).toUpperCase()}}};var A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"avatar-wrapper",style:t.sessionAvatarStyle},[t.session.userId?e("NcAvatar",{attrs:{user:t.session.userId?t.session.userId:t.session.guestName,"is-guest":t.session.userId===null,"disable-menu":!0,"hide-status":"","disable-tooltip":!0,size:t.size}}):e("div",{staticClass:"avatar",style:t.sessionBackgroundStyle},[t._v(" "+t._s(t.guestInitial)+" ")])],1)},S=[],w=i(x,A,S,!1,null,"b631186e");const n=w.exports,z={name:"GuestNameDialog",components:{AvatarWrapper:n},props:{session:{type:Object,required:!0}},setup(){const{connection:t}=d();return{connection:t}},data(){return{guestName:"",guestNameBuffered:""}},computed:{avatarUrl(){const t=v("/avatar/guest/{user}/{size}",{user:this.guestNameBuffered,size:32});return window.location.protocol+"//"+window.location.host+t}},beforeMount(){this.guestName=this.session.guestName,this.updateBufferedGuestName()},methods:{setGuestName(){if(!this.connection){o(a("text","Not connected. Cannot update guest name."));return}const t=this.session.guestName;m(this.guestName,this.connection).then(()=>{localStorage.setItem("nick",this.guestName),this.updateBufferedGuestName()}).catch(e=>{console.warn("Failed to update the session",{error:e}),u(a("text","Failed to update the guest name.")),this.guestName=t})},updateBufferedGuestName(){this.guestNameBuffered=this.guestName},t:a}};var I=function(){var t=this,e=t._self._c;return e("form",{staticClass:"guest-name-dialog",attrs:{title:t.t("text","Enter your name so other people can see who is editing")},on:{submit:function(s){return s.preventDefault(),t.setGuestName()}}},[e("label",[e("AvatarWrapper",{attrs:{session:t.session,size:32}})],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.guestName,expression:"guestName"}],attrs:{type:"text","aria-label":t.t("text","Edit guest name"),placeholder:t.t("text","Guest")},domProps:{value:t.guestName},on:{input:function(s){s.target.composing||(t.guestName=s.target.value)}}}),e("input",{staticClass:"icon-confirm",attrs:{type:"submit","aria-label":t.t("text","Save guest name"),value:""}})])},k=[],B=i(z,I,k,!1,null,"a19e0dd4");const G=B.exports,M={name:"SessionList",components:{AccountMultipleOutlineIcon:C,AvatarWrapper:n,GuestNameDialog:G,NcButton:c,NcPopover:l},props:{sessions:{type:Object,default:()=>({})}},setup(){const{isPublic:t}=g();return{isPublic:t}},data(){return{myName:""}},computed:{label(){return a("text","Active people")},participantsPopover(){return this.currentSession?.guestName?this.participantsWithoutCurrent:this.participants},participantsWithoutCurrent(){return this.participants.filter(t=>!t.isCurrent)},participants(){return Object.values(this.sessions).filter(t=>t.lastContact>Date.now()/1e3-f&&(t.userId!==null||t.guestName!==null)).sort((t,e)=>t.lastContact<e.lastContact)},showGuestNameDialog(){return this.isPublic&&this.currentSession&&!this.currentSession.userId},currentSession(){return Object.values(this.sessions).find(t=>t.isCurrent)},avatarStyle(){return t=>({opacity:t.lastContact>Date.now()/1e3-h?1:.5})},sessionsVisible(){return this.participantsWithoutCurrent.slice(0,3)}},methods:{t:a}};var D=function(){var t=this,e=t._self._c;return e("NcPopover",{staticClass:"session-list",attrs:{"no-focus-trap":!t.showGuestNameDialog,placement:"bottom"},scopedSlots:t._u([{key:"trigger",fn:function({attrs:s}){return[e("div",[e("NcButton",t._b({staticClass:"avatar-list",attrs:{title:t.label,"aria-label":t.label,type:"tertiary"},scopedSlots:t._u([{key:"icon",fn:function(){return[e("AccountMultipleOutlineIcon",{attrs:{size:20}}),t._l(t.sessionsVisible,function(r){return e("AvatarWrapper",{key:r.id,attrs:{session:r,size:28}})})]},proxy:!0}],null,!0)},"NcButton",s,!1))],1)]}},{key:"default",fn:function(){return[e("div",{staticClass:"session-menu"},[t._t("lastSaved"),e("ul",[t.showGuestNameDialog?e("GuestNameDialog",{attrs:{session:t.currentSession}}):t._e(),t._l(t.participantsPopover,function(s){return e("li",{key:s.id,style:t.avatarStyle(s)},[e("AvatarWrapper",{attrs:{session:s,size:36}}),e("span",{staticClass:"session-label"},[t._v(" "+t._s(s.userId?s.displayName:s.guestName?s.guestName:t.t("text","Guest"))+" ")]),s.userId===null?e("span",{staticClass:"guest-label"},[t._v("("+t._s(t.t("text","guest"))+")")]):t._e()],1)})],2)],2)]},proxy:!0}],null,!0)})},W=[],O=i(M,D,W,!1,null,"545f8326");const X=O.exports;export{X as default};
//# sourceMappingURL=SessionList-DjGyyqFh.chunk.mjs.map
