const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-P9QQ6yIi.chunk.mjs'),window.OC.filePath('text', '', 'js/index-CBjMXwUt.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-DwlFXcXb.chunk.mjs'),window.OC.filePath('text', '', 'js/NcNoteCard-C6xb7vi0-heg1YLQA.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DfiDB3im.chunk.mjs'),window.OC.filePath('text', '', 'js/vue.runtime.esm-CuYTBykc.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-CAT7lyY8.chunk.mjs'),window.OC.filePath('text', '', 'js/index-CCUE3e_p.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-Bs0OvbBQ.chunk.css'),window.OC.filePath('text', '', 'css/NcNoteCard-C6xb7vi0-wlRKa3ok.chunk.css'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer-XSZyZ-Zg.chunk.mjs'),window.OC.filePath('text', '', 'js/RichWorkspace-wHHOnbT5.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-CrUv8Kxz.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-De-w88sJ.chunk.mjs'),window.OC.filePath('text', '', 'js/EditorOutline-Tonj55YA.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-BIEYfWtF-BI4lbf0k.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-BIEYfWtF-CKL5tLCP.chunk.css'),window.OC.filePath('text', '', 'js/MediaHandler.provider-DL-Z-WfN.chunk.mjs'),window.OC.filePath('text', '', 'js/logger-C5ZHccIX.chunk.mjs'),window.OC.filePath('text', '', 'css/EditorOutline-ByT6bE43.chunk.css'),window.OC.filePath('text', '', 'js/BaseReader-DbxqvuXr.chunk.mjs'),window.OC.filePath('text', '', 'css/BaseReader-B2SKr28z.chunk.css'),window.OC.filePath('text', '', 'css/RichTextReader-9VE4RsKi.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-DcdLMycK.chunk.css')])))=>i.map(i=>d[i]);
import{_ as u,a as f,e as h}from"./index-CBjMXwUt.chunk.mjs";import{t as l,c as E}from"./NcLoadingIcon-CAT7lyY8.chunk.mjs";import{g as I,s as F,a as A}from"./NcNoteCard-C6xb7vi0-heg1YLQA.chunk.mjs";import{V as R}from"./vue.runtime.esm-CuYTBykc.chunk.mjs";import{H as g,a as y,N as O}from"./index-CBforXbg.chunk.mjs";import{l as D}from"./index-DfiDB3im.chunk.mjs";import{h as H}from"./index-CCUE3e_p.chunk.mjs";import{b as m}from"./mime-DDg3sTIz.chunk.mjs";import{F as C,P as w}from"./dav-CQDyL7M_-nhAalrOL.chunk.mjs";import"./emoji-picker-DwlFXcXb.chunk.mjs";const T='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',_="Edit with text app",z=()=>{const t=I(),e=document.querySelector("#preview table.files-filestable");if(!t||!e){const o=document.createElement("div");o.id="text-viewer-fallback",document.body.appendChild(o);const a=r=>OCA.Files.fileActions.register(r,_,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,H("core","actions/rename"),n=>{const c=window.FileList.findFile(n);Promise.all([u(()=>import("./vue.runtime.esm-CuYTBykc.chunk.mjs").then(s=>s.z),[],import.meta.url),u(()=>import("./PublicFilesEditor-P9QQ6yIi.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]),import.meta.url)]).then(s=>{const k=window.FileList.getCurrentDirectory()+"/"+n,b=s[0].default,v=s[1].default;new b({render:x=>x(v,{props:{fileId:c?c.id:null,active:!0,shareToken:t,relativePath:k,mimeType:c.mimetype},on:{close:()=>{(void 0).$destroy()}}})}).$mount(o)})},l("text","Edit"));for(let r=0;r<m.length;r++)a(m[r]),OCA.Files.fileActions.setDefault(m[r],_)}},B=()=>{const t=l("text","Readme")+"."+D("text","default_file_extension");y({id:"rich-workspace-init",displayName:l("text","Add folder description"),category:O.Other,enabled(e){return Number(e.attributes["rich-workspace-file"])?!1:(e.permissions&w.CREATE)!==0},iconSvgInline:T,async handler(e,o){if(o.map(s=>s.basename).includes(t)){F(l("text",'"{name}" already exist!',{name:t}));return}const a=e.encodedSource+"/"+encodeURIComponent(t),r=await E({method:"PUT",url:a,headers:{Overwrite:"F"}}),n=parseInt(r.headers["oc-fileid"]),c=new C({source:e.source+"/"+t,id:n,mtime:new Date,mime:"text/markdown",owner:f()?.uid||null,permissions:w.ALL,root:e?.root||"/files/"+f()?.uid});A(l("text",'Created "{name}"',{name:t})),e.attributes["rich-workspace-file"]=n,e.attributes["rich-workspace"]="",h("files:node:created",c),h("files:node:updated",e)}})};let p,i,d;const Z=new g({id:"workspace",order:10,enabled(t,e){return["files","favorites","public-share"].includes(e.id)},render:async(t,e)=>{d=e,p||(p=(await u(()=>import("./RichWorkspace-wHHOnbT5.chunk.mjs"),__vite__mapDeps([11,6,2,5,1,7,8,4,3,9,12,13,14,15,16,10,17,18,19,20,21,22,23]),import.meta.url)).default),i&&(i.$destroy(),console.debug("Destroying existing FilesHeaderRichWorkspaceInstance"));const o=!!d.attributes["rich-workspace-file"],a=d.attributes["rich-workspace"]||"",r=d.path||"";i=new R({extends:p,propsData:{content:a,hasRichWorkspace:o,path:r}}).$mount(t),window.FilesHeaderRichWorkspaceInstance=i},updated(t){if(d=t,!i){console.error("No vue instance found for FilesWorkspaceHeader");return}const e=!!t.attributes["rich-workspace-file"];i.hasRichWorkspace=e,i.content=t.attributes["rich-workspace"]||"",i.path=t.path||""}});export{_ as FILE_ACTION_IDENTIFIER,Z as FilesWorkspaceHeader,B as addMenuRichWorkspace,z as registerFileActionFallback};
//# sourceMappingURL=files-BxZ-Jsfb.chunk.mjs.map
